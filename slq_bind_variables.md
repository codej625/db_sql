# SQL 바인드 변수 (Bind Variables)

<br />
<br />

* 바인드 변수를 왜 사용할까?

---

```
바인드 변수는 SQL 쿼리 내에서 값이 동적으로 변할 수 있는 부분을 나타내는 플레이스홀더(Placeholder)이다.

쿼리 자체는 변경되지 않고,
플레이스홀더에 들어갈 실제 값만 쿼리 실행 시점에 별도로 전달된다.
(즉 어느정도 SQL 인젝션 공격 방어가 가능)
```

<br />
<br />
<br />
<br />

1. 이점

<br />

`SQL 인젝션 공격 방어`

```
사용자 입력을 SQL 쿼리 문자열에 직접 연결하면,
악의적인 사용자가 SQL 명령어를 주입하여 데이터베이스를 조작하거나 민감한 정보를 탈취할 수 있다.
(password' OR '1'='1)
```

```
바인드 변수를 사용하면 데이터베이스가 사용자 입력을 코드(실행될 명령)가 아닌 데이터(매개변수 값)로 명확하게 인식하게 된다.

어떤 문자열이 들어와도 단순한 데이터로 처리되므로,
SQL 명령으로서 실행될 위험이 없다.
```

<br />

`성능 향상`

```
매번 다른 값으로 쿼리 문자열을 새로 생성하면,
데이터베이스는 쿼리를 실행할 때마다 구문 분석(Parsing) 및 최적화(실행 계획 생성) 과정을 반복해야 한다.

이는 오버헤드를 발생시킨다.
```

```
바인드 변수를 사용하면 쿼리의 "구조"는 항상 동일하게 유지된다.

데이터베이스는 한 번 구문 분석하고 실행 계획을 생성한 후 이를 캐시에 저장해두고,
후속 요청에서 값이 달라지더라도 동일한 캐시된 실행 계획을 재사용할 수 있다.

이는 쿼리 실행 시간을 단축시키고 서버 부하를 줄여준다.
```

<br />
<br />
<br />

2. 예시

<br />

`안 좋은 예 (SQL 인젝션 위험, 성능 저하)`

```sql
/* 사용자 입력으로 'John'이 들어왔을 때 */

SELECT * FROM Users WHERE username = 'John';

/* 사용자 입력으로 'Admin'이 들어왔을 때 */

SELECT * FROM Users WHERE username = 'Admin';
```

<br />

`좋은 예 (바인드 변수 사용)`

```sql
/* username에 'Admin'을 바인딩하여 실행 (동일한 쿼리 구조로 인식, 캐시된 실행 계획 재사용 가능) */

SELECT * FROM Users WHERE username = :username;
```
